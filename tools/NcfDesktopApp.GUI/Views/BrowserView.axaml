<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:NcfDesktopApp.GUI.ViewModels"
             xmlns:controls="using:NcfDesktopApp.GUI.Views.Controls"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="NcfDesktopApp.GUI.Views.BrowserView"
             x:DataType="vm:MainWindowViewModel">
    
    <Grid RowDefinitions="Auto,*">
        
        <!-- é¡¶éƒ¨å·¥å…·æ  -->
        <Border Grid.Row="0" Background="#F8F9FA" BorderBrush="#DEE2E6" BorderThickness="0,0,0,1" Padding="10">
            <Grid ColumnDefinitions="Auto,*,Auto,Auto,Auto">
                
                <!-- å¯¼èˆªæŒ‰é’® -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="5">
                    <Button Name="BackButton" 
                            Content="â†" 
                            Width="30" Height="30" 
                            FontSize="16" FontWeight="Bold"
                            ToolTip.Tip="åŽé€€"
                            Click="BackButton_Click"/>
                    <Button Name="ForwardButton" 
                            Content="â†’" 
                            Width="30" Height="30" 
                            FontSize="16" FontWeight="Bold"
                            ToolTip.Tip="å‰è¿›"
                            Click="ForwardButton_Click"/>
                    <Button Name="RefreshButton" 
                            Content="â†»" 
                            Width="30" Height="30" 
                            FontSize="16" FontWeight="Bold"
                            ToolTip.Tip="åˆ·æ–°"
                            Click="RefreshButton_Click"/>
                </StackPanel>
                
                <!-- URLæ˜¾ç¤º -->
                <Border Grid.Column="1" 
                        Background="White" 
                        BorderBrush="#CED4DA" 
                        BorderThickness="1" 
                        CornerRadius="4" 
                        Margin="10,0"
                        Padding="8,5">
                    <TextBlock Name="UrlDisplay" 
                               Text="{Binding SiteUrl}" 
                               FontFamily="Consolas" 
                               FontSize="12"
                               Foreground="#495057"
                               VerticalAlignment="Center"
                               TextTrimming="CharacterEllipsis"
                               ToolTip.Tip="{Binding SiteUrl}"/>
                </Border>
                
                <!-- çŠ¶æ€æŒ‡ç¤ºå™¨ -->
                <Border Grid.Column="2" 
                        Background="{Binding StatusColor}" 
                        CornerRadius="10" 
                        Width="20" Height="20" 
                        Margin="0,0,10,0"
                        ToolTip.Tip="{Binding CurrentStatus}">
                    <TextBlock Text="â—" 
                               Foreground="White" 
                               HorizontalAlignment="Center" 
                               VerticalAlignment="Center" 
                               FontSize="12"/>
                </Border>
                
                <!-- å…³é—­æ ‡ç­¾æŒ‰é’® -->
                <Button Grid.Column="3" 
                        Content="âœ•" 
                        Width="30" Height="30" 
                        FontSize="14"
                        FontWeight="Bold"
                        ToolTip.Tip="å…³é—­æ ‡ç­¾é¡µ"
                        Background="#DC3545"
                        Foreground="White"
                        CornerRadius="4"
                        Margin="0,0,5,0"
                        Command="{Binding CloseBrowserTabCommand}"/>
                
                <!-- è®¾ç½®æŒ‰é’® -->
                <Button Grid.Column="4" 
                        Content="âš™" 
                        Width="30" Height="30" 
                        FontSize="16"
                        ToolTip.Tip="æ‰“å¼€è®¾ç½®"
                        Command="{Binding SwitchToSettingsCommand}"/>
            </Grid>
        </Border>
        
        <!-- æµè§ˆå™¨å†…å®¹åŒºåŸŸ -->
        <Border Grid.Row="1" Background="White">
            <Grid>
                <!-- åŠ è½½çŠ¶æ€è¦†ç›–å±‚ -->
                <Border Name="LoadingOverlay" 
                        Background="#F8F9FA" 
                        IsVisible="{Binding !IsBrowserReady}">
                    <StackPanel HorizontalAlignment="Center" 
                                VerticalAlignment="Center" 
                                Spacing="20">
                        <TextBlock Text="ðŸŒ" 
                                   FontSize="48" 
                                   HorizontalAlignment="Center"/>
                        <TextBlock Text="æ­£åœ¨å‡†å¤‡æµè§ˆå™¨..." 
                                   FontSize="16" 
                                   HorizontalAlignment="Center" 
                                   Foreground="#6C757D"/>
                        <ProgressBar IsIndeterminate="True" 
                                     Width="200" 
                                     Height="4"/>
                    </StackPanel>
                </Border>
                
                <!-- å†…åµŒæµè§ˆå™¨æŽ§ä»¶ -->
                <controls:CefWebView Name="WebViewControl"
                                       Source="{Binding SiteUrl}"
                                       IsVisible="{Binding IsBrowserReady}"/>
                
                <!-- é”™è¯¯çŠ¶æ€æ˜¾ç¤º -->
                <Border Name="ErrorOverlay" 
                        Background="#FFF5F5" 
                        IsVisible="{Binding HasBrowserError}">
                    <StackPanel HorizontalAlignment="Center" 
                                VerticalAlignment="Center" 
                                Spacing="15">
                        <TextBlock Text="âš ï¸" 
                                   FontSize="48" 
                                   HorizontalAlignment="Center"/>
                        <TextBlock Text="æµè§ˆå™¨åŠ è½½å¤±è´¥" 
                                   FontSize="18" 
                                   FontWeight="SemiBold"
                                   HorizontalAlignment="Center" 
                                   Foreground="#DC3545"/>
                        <TextBlock Text="{Binding BrowserErrorMessage}" 
                                   FontSize="14" 
                                   HorizontalAlignment="Center" 
                                   Foreground="#6C757D"
                                   TextWrapping="Wrap"
                                   MaxWidth="400"/>
                        <Button Content="é‡è¯•" 
                                Command="{Binding RetryBrowserCommand}"
                                HorizontalAlignment="Center"
                                Padding="20,8"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>
    </Grid>
</UserControl> 